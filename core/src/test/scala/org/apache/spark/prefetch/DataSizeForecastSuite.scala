/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.apache.spark.prefetch

import org.apache.spark.SparkFunSuite

class DataSizeForecastSuite extends SparkFunSuite{

  val timeConstraint = new DataSizeForecast()
  // scalastyle:off println

  test("Forecast next time window data size") {
    val series = Array(
      1824755,
      2915405,
      2373731,
      2052338,
      3826245,
      1465731,
      4116141,
      3873183,
      3415149,
      3354862,
      3622460,
      6185811,
      3564385,
      3464202,
      3089323,
      2435306,
      3289188,
      2996908,
      2414186,
      3256301,
      5472837,
      3767613,
      2241086,
      2840603,
      2579690,
      1847766,
      6246443,
      3240314,
      4409084,
      5425027,
      2797510,
      2513554,
      3369968,
      2147900,
      2541331,
      2354390,
      5278950,
      3918841,
      4959134,
      2395400,
      1659420,
      2169261,
      5626492,
      6083564,
      7750724,
      4505330,
      4492937,
      3976804,
      3075803,
      2340457,
      3522419,
      3020692,
      2119838,
      5283798,
      2541961,
      3451449,
      2726213,
      3437642,
      4741565,
      2819360,
      3524022,
      2119765,
      3159293,
      4662252,
      4260335,
      6075845,
      1028900,
      4890962,
      3247851,
      5698804,
      4020941,
      5421887,
      3777408,
      2225361,
      4793962,
      3621114,
      3090824,
      4609273,
      3677473,
      3364296,
      2495073,
      3781151,
      2781171,
      2730800,
      3914328,
      2730633,
      2594941,
      1677669,
      2000122,
      2522376,
      5805826,
      6307980,
      3656145,
      2871453,
      2939595,
      3693707,
      3447018,
      5556673,
      4283821,
      2986405,
      1940832,
      2100873,
      2572391,
      3476214,
      3277684,
      2131803,
      1978819,
      2433181,
      2026749,
      1196543,
      1999719,
      1179308,
      1836733,
      2934199,
      1831121,
      1420233,
      3694988,
      1962142,
      2791858,
      2807402,
      2745041,
      2387817,
      1875418,
      2280909,
      1702122,
      1702407,
      1958449,
      1247241,
      2078213,
      1989871,
      6708341,
      3624694,
      1727559,
      2294328,
      1949054,
      3147986,
      1702511,
      2012701,
      2138064,
      1590425,
      1900662,
      1358573,
      1565632,
      2522043,
      1313188,
      1332857,
      1668867,
      1821283,
      1783424,
      1468485,
      2141143,
      1861513,
      1578387,
      2044234,
      1814640,
      1069205,
      2716907,
      2185721,
      2865074,
      2680307,
      2110103,
      2650001,
      2997047,
      2020794,
      1878510,
      1867889,
      1382107,
      2415258,
      2430595,
      2426300,
      1500903,
      2110504,
      1961896,
      2450818,
      3548418,
      2880870,
      2556379,
      4280543,
      2348591,
      1785894,
      2398266,
      1778672,
      1193955,
      1360046,
      1895510,
      1931035,
      1409928,
      1578131,
      1432940,
      3548823,
      1860654,
      1984482,
      2357218,
      2110086,
      2825818,
      1101434,
      4131521,
      2473023,
      2321500,
      2417644,
      1910762,
      1750170,
      3196344,
      1189764,
      870409,
    1459197,
    2478051,
    2415795,
    1810391,
    3053347,
    2118503,
    2326895,
    2349926,
    2714297,
    2022610,
    1685454,
    3209227,
    4136283,
    1893211,
    2954031,
    1578464,
    779696,
    714431,
    653055,
    1127980,
    941447,
    1916160,
    1866651,
    1777472,
    1463208,
    2659468,
    1757647,
    1623330,
    2946738,
    2562236,
    2335194,
    1835957,
    1699534,
    3008458,
    2769350,
    3063559,
    2656341,
    4669012,
    2536290,
    2163031,
    3743153,
    3529054,
    2929252,
    2911877,
    2283870,
    1609451,
    1975290,
    1760468,
    2148202,
    2347270,
    3097011,
    1786277,
    6553839,
    4838795,
    4629755,
    2407171,
    2392783,
    3375173,
    2400946,
    3123781,
    2876261,
    2488373,
    2841919,
    3113546,
    5178833,
    3247154,
    2563418,
    3421731,
    1652324,
    2318832,
    1745218,
    1437471,
    1294681,
    1804350,
    1808447,
    2762931,
    1985703,
    1727269,
    2560731,
    2972614,
    2006941,
    2190772,
    2090720,
    1919493,
    1603010,
    2307668,
    2584538,
    1842491,
    2017519,
    1966409,
    2591968,
    2840577,
    2172515,
    1243513,
    2061997,
    1185867,
    1475541,
    894232,
    1806441,
    1580495,
    3009046,
    3359741,
    1678627,
    1472407,
    2080946,
    2087256,
    2224227,
    2219204,
    2209139,
    1287905,
    2042132,
    1465527,
    2591684,
    5740663,
    2405753,
    2742131,
    1840126,
    1102300,
    1686139,
    3510829,
    1190619,
    1807185,
    1558720,
    2547039,
    1274846,
    1842298,
    1145664,
    1833063,
    1285879,
    1188782,
    1267805,
    1410610,
    1677989,
    1054865,
    1174434,
    1328510,
    1114749,
    3149546,
    2029378,
    1435625,
    1125825,
    1060501,
    1102367,
    1519046,
    1314906,
    2010785,
    1414957,
    600744,
    949243,
    1615912,
    1278504,
    1189340,
    1183288,
    1487761,
    2094496,
    1868521,
    4404085,
    1706174,
    1983914,
    2411722,
    1453645,
    2534358,
    1719615,
    1510223,
    2003109,
    1371335,
    2708121,
    957560,
    957560,
    1733728,
    1568834,
    1628472,
    1766002,
    1252725,
    2642075,
    1721261,
    3478558,
    5578794,
    2761606,
    1192963,
    1846569,
    1228385,
    1439567,
    967137,
    888727,
    1193004,
    1395449,
    1979934,
    2015566,
    1478032,
    790594,
    908184,
    1345766,
    1286053,
    1477856,
    995855,
    2590395,
    1621086,
    1379832,
    2710468,
    2867046,
    2173992,
    1686631,
    1632282,
    1650529,
    1629584,
    2218441,
    1626565,
    2120557,
    2481276,
    1708052,
    1577280,
    1157370,
    1515558,
    2124682,
    2526263,
    5133638,
    2527277,
    3972861,
    4723905,
    5362096,
    3810818,
    4942206,
    2231876,
    2161086,
    1754719,
    1508194,
    1105293,
    1714329,
    1484268,
    2504261,
    2087828,
    4559916,
    5765189,
    2341387,
    2968264,
    2458734,
    2583931,
    2163823,
    2504261,
    1805461,
    1331282,
    2697164,
    5891377,
    4012147,
    2303826,
    5306170,
    2122424,
    2713879,
    1752695,
    1091780,
    4411159,
    2014436,
    2250275,
    1346823,
    1019549,
    1425753,
    1803210,
    2654911,
    1640864,
    2335765,
    4510349,
    3849394,
    3508188,
    3104066,
    3736336,
    1590221,
    1872341,
    1426901,
    588034,
    976423,
    1323452,
    1423993,
    1530798,
    2042240,
    2084562,
    3359660,
    2116341,
    1644939,
    2771191,
    2013474,
    5134006,
    2630296,
    3003980,
    5033605,
    2721609,
    4856573,
    1519250,
    1511214,
    1703508,
    2033523,
    2329983,
    3054313,
    2508493,
    2950375,
    2567439,
    1826367,
    2697212,
    3586102,
    1408747,
    3337005,
    1317705,
    2211931,
    2875788,
    9007218,
    3737331,
    2971880,
    1967913,
    1922102,
    2343479,
    1505418,
    1676351,
    1847082,
    1635437,
    1305992,
    1376468,
    1528564,
    1492378,
    1961299,
    2064355,
    2719895,
    4704560,
    2551437,
    1504881,
    1295556,
    1085684,
    2315472,
    1835393,
    3625952,
    2776181,
    1573740,
    1932749,
    2064181,
    1659179,
    2170331,
    2135918,
    2379808,
    3072418,
    2443178,
    1332519,
    3370597,
    3708641,
    1777705,
    1445622,
    1070232,
    2333369,
    1410574,
    1719710,
    2726140,
    3973179,
    2200155,
    2298298,
    1803453,
    2160963,
    1726312,
    1880177,
    1073820,
    1254801,
    934611,
    999682,
    1034717,
    975490,
    2617833,
    1992774,
    2883667,
    2147413,
    1966147,
    5277345,
    2652326,
    2126257,
    1484752,
    1919645,
    2507443,
    3347403,
    5022554,
    2440065,
    2947454,
    2722286,
    4091870,
    1760467,
    1353411,
    1439015,
    1789330,
    1576987,
    2769551,
    2361878,
    1422563,
    1519421,
    1865267,
    2658779,
    3909250,
    2053553,
    6127695,
    5265822,
    3350458,
    2516360,
    3037436,
    4486572,
    2160799,
    2509428,
    2927761,
    3390976,
    2237945,
    2107093,
    1579730,
    2801301,
    2247745,
    1826485,
    2412373,
    1155252,
    1160904,
    2949376,
    1708801,
    1844946,
    5261424,
    2768225,
    2014066,
    2440415,
    2247715,
    2104591,
    1448062,
    949479,
    1932226,
    1513076,
    1554542,
    1575708,
    3440282,
    2848895,
    2632739,
    3302058,
    6416891,
    2730429,
    2145028,
    3828206,
    4114990,
    3802732,
    3233814,
    2406297,
    1783861,
    2554666,
    2954093,
    2119191,
    2140822,
    2819027,
    1787408,
    1885293,
    1628726,
    1443721,
    2223319,
    1752721,
    2130117,
    1819067,
    3352296,
    2640363,
    2283337,
    1962552,
    2028940,
    2730672,
    2615440,
    2252364,
    2545749,
    3011460,
    3519448,
    1675429,
    1833679,
    3089575,
    2598314,
    3232938,
    1349866,
    2383212,
    1647407,
    1432995,
    1754319,
    3685845,
    2635777,
    2886412,
    3696278,
    2732645,
    1948411,
    2557172,
    1780126,
    1352267,
    2194619,
    1810869,
    1485779,
    1569620,
    1419963,
    1964478,
    3109588,
    4339800,
    1969168,
    3096336,
    3335092,
    2490208,
    7679493,
    6589609,
    7275136,
    5447723,
    6474141,
    5669066,
    3797067,
    1935738,
    3208114,
    7989220,
    4713210,
    3314529,
    2519309,
    2004492,
    4331832,
    4133291,
    3709240,
    2634362,
    2310538,
    2195375,
    2582642,
    2218837,
    3364796,
    1735159,
    1643172,
    1510716,
    874549,
    1458242,
    1757360,
    834358,
    1450968,
    3287335,
    2587246,
    2103619,
    3504314,
    3736768,
    2818611,
    1989379,
    4206638,
    2893372,
    2994386,
    2506559,
    2469088,
    2298372,
    1834467,
    1831240,
    1755032,
    1479446,
    3479452,
    2959863,
    2666567,
    1742325,
    2128426,
    2833492,
    4424609,
    3888601,
    3464464,
    3169951,
    3224004,
    3923627,
    2903649,
    5382312,
    2231481,
    2339426,
    1792962,
    1282290,
    1454952,
    1453515,
    944266,
    2187500,
    2760200,
    3612508,
    946823,
    1124968,
    1221574,
    1801486,
    1614633,
    1614998,
    1517348,
    929638,
    1059439,
    1956125,
    1895669,
    2504361,
    2172615,
    1552312,
    1554822,
    993627,
    1272724,
    1091198,
    783495,
    3143468,
    2857844,
    2958061,
    1900659,
    1566612,
    1373839,
    1106293,
    1049336,
    992495,
    2495340,
    1347753,
    1442264,
    1536678,
    1640774,
    1243893,
    1670389,
    1396272,
    1500449,
    1868970,
    1189462,
    1549792,
    2028332,
    1285318,
    1333991,
    1602991,
    1083956,
    1403483,
    1741539,
    2094305,
    3328961,
    2504924,
    2430565,
    3979321,
    7130371,
    3476470,
    3660160,
    2567686,
    1689755,
    3236305,
    2352424,
    2569626,
    1823120,
    2256373,
    1734386,
    2209387,
    2395816,
    2359193,
    1500872,
    1552146,
    1204415,
    1261698,
    1272833,
    1624087,
    2029194,
    1784741,
    3434813,
    3161329,
    2112964,
    2412064,
    1487938,
    5263644,
    4328364,
    4300845,
    2402578,
    2181066,
    1591476,
    1813468,
    2312133,
    1861536,
    1838137,
    1094683,
    2237748,
    1852475,
    1192500,
    1202638,
    1362884,
    2583860,
    2124914,
    1226365,
    1512440,
    1720649,
    1792674,
    1572573,
    1945517,
    1881372,
    1604639,
    1595948,
    1508868,
    1700182,
    1250805,
    1311724,
    1006170,
    754137,
    1377024,
    1538976,
    2323589,
    3175994,
    3154934,
    4660295,
    3340438,
    1626833,
    1645348,
    2634707,
    2160074,
    1581245,
    1332975,
    2231203,
    1676587,
    1257886,
    1424454,
    1460928,
    1542576,
    884738,
    2507018,
    1835434,
    3461832,
    1604806,
    1733971,
    2592850,
    1927900,
    2333122,
    1612736,
    1307074,
    1957032,
    2639060,
    1587143,
    1502533,
    1938218,
    1754316,
    1539625,
    1763985,
    1432268,
    1772801,
    1663127,
    1544958,
    2912537,
    1736076,
    1336023,
    997137,
    1160321,
    1949108,
    1769090,
    1493608,
    1011340,
    1666388,
    3949609,
    2146178,
    2393625,
    1471348,
    1556762,
    2133116,
    2240428,
    2510054,
    2220908,
    1723957,
    2136740,
    3501243,
    2558722,
    2219255,
    3443200,
    4710170,
    4026754,
    2070609,
    3148538,
    2540067,
    2831226,
    1926275,
    877140,
    2241795,
    1952118,
    2238575,
    2823273,
    2153515,
    2495020,
    1136658,
    1815238,
    1848936,
    1937622,
    1851517,
    1734678,
    2044052,
    1338905,
    2103155,
    1084164,
    1552366,
    1652288,
    968296,
    727682,
    1535489,
    1177275,
    891398,
    1216100,
    1739726,
    1821264,
    1503763,
    2883483,
    2575328,
    1560549,
    5624332,
    3276952,
    1568923,
    1939449,
    1523508,
    1346142,
    1701695,
    2013878,
    2741915,
    3073228,
    1895562
    ).map(tv => java.lang.Long.valueOf(tv))
    println(s"next is ${timeConstraint.forecastNext(series)}")
  }

  test("Forecast next n time windows data size") {
    val series = Array(10, 20, 30, 40, 50, 60, 70, 80, 90, 100)
      .map(tv => java.lang.Long.valueOf(tv))
    println(s"next n(${5}) are ${timeConstraint.forecastNextN(series, 5)}")
  }
}
